<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Required meta tags -->
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

  <link rel="stylesheet" type="text/css" href="https://js.api.here.com/v3/3.0/mapsjs-ui.css?dp-version=1549984893" />
  <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-core.js"></script>
  <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-service.js"></script>
  <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-ui.js"></script>
  <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-mapevents.js"></script>

  <link rel="stylesheet" type="text/css" href="static/style.css">
</head>
<body>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/view">Tracker</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCentered" aria-controls="navbarCentered" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-md-center" id="navbarCentered">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="#">&lt;&lt; Prev Day</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" id="toggle_lines" onclick="toggleLines();return false;">Show Lines</a>
        </li>
        <li class="nav-item">
          <a class="nav-link disabled" href="#">Next Day &gt;&gt;</a>
        </li>
      </ul>
    </div>
  </nav>

  <main role="main" class="container-fluid">

  <div style="padding-top: 4em;">
    <div id="map"/>
  </div>

  </main>
  <script  type="text/javascript" charset="UTF-8" >
/**
* Switches the map type to a topographical map
*
* @param  {H.Map} map    A HERE Map instance within the application
* @param  {H.service.Platform} platform    A stub class to access HERE services
*/
function switchMapType(map, platform){
  var aerialMapTileService = platform.getMapTileService({
    type: 'aerial'
  });
  terrainMap = aerialMapTileService.createTileLayer(
    'maptile',
    'terrain.day',
    pixelRatio === 1 ? 256 : 512,
    'png8',
    {ppi: pixelRatio === 1 ? undefined : 320}
  );
  map.setBaseLayer(terrainMap);
}

/**
* Initialize map
*/
function initMap({redraw=1, lines=0} = {}){
  //Step 1: initialize communication with HERE maps platform
  var platform = new H.service.Platform({
    app_id: '{{ g.HERE_APP_ID }}',
    app_code: '{{ g.HERE_APP_CODE }}',
    useHTTPS: true
  });
  var pixelRatio = window.devicePixelRatio || 1;
  var defaultLayers = platform.createDefaultLayers({
    tileSize: pixelRatio === 1 ? 256 : 512,
    ppi: pixelRatio === 1 ? undefined : 320
  });

  //Step 2: initialize the map
  var map = new H.Map(document.getElementById('map'),
    defaultLayers.normal.map,{
      center: {lat:27.98805, lng:86.9250},
      zoom: 10,
      pixelRatio: pixelRatio
    });

  //Step 3: make the map interactive
  // MapEvents enables the event system
  // Behavior implements default interactions for pan/zoom (also on mobile touch environments)
  var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));

  // Create the default UI components
  var ui = H.ui.UI.createDefault(map, defaultLayers);
  // Remove map settings as unnecessary
  ui.removeControl('mapsettings');

  // Now use the map as required...
  switchMapType(map, platform);
}

function toggleLines() {
  var togglelink = document.getElementById("toggle_lines");
  if (showLines == 0) {
    showLines = 1;
    togglelink.innerHTML = "Hide Lines";
  } else {
    showLines = 0;
    togglelink.innerHTML = "Show Lines";
  }
  initMap({ redraw: 0, lines: showLines });
}

var showLines = 0;
initMap();
  </script>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>
